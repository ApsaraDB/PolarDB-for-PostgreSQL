pg_trgm - PostgreSQLで3-gramの全文検索を使えるようにするツール
pg_bigm - PostgreSQLで2-gramの全文検索を使えるようにするツール
pg_bigmは検索性能を200%向上させました
GINインデックスを利用して全文検索用のインデックスを作成します
ここは東京都
東京と京都に行く
pg_bigm.gin_key_limitは、検索文字列の2-gram文字列のうち
最大で何個を全文検索インデックスの検索に使うか指定するパラメータです。
設定値が0(デフォルト値)の場合は、検索文字列のすべての
2-gram文字列をインデックス検索に使います。
このパラメータは、postgresql.confとSET文
(スーパーユーザに限らずどのユーザからでも)で設定値を変更できます。
pg_bigmの全文検索では、基本的に、検索文字列のすべての
2-gram文字列を使ってGINインデックスを検索します。
ただし、現在のGINインデックスの実装では、
検索に使う2-gram文字列の個数が多いほど
インデックス検索の負荷は高くなります。
このため、検索文字列の文字数が多く、
2-gram文字列の個数が多くなりやすいシステムでは、
検索性能は劣化しやすいです。
pg_bigm.gin_key_limitによりGINインデックスの検索に使う
2-gram文字列の最大数を制限することで、
この性能問題を解決できます。
ただし、インデックス検索に使う2-gram文字列の個数が減ると、
インデックスから取得した検索結果候補にはより
多くの誤った結果が含まれることになります。
このため、Recheckの負荷が高まり、逆に、
より性能劣化する可能性もあるため注意が必要です。
引数1がNULLの場合、戻り値はNULLです。
